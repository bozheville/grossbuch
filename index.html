<!DOCTYPE html>
<html ng-app="tuugobank">
<head>
    <title>TuugoTV</title>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/skeleton/1.2/base.min.css"/>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/skeleton/1.2/layout.css"/>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/skeleton/1.2/skeleton.min.css"/>
    <script src="//code.angularjs.org/1.2.9/angular.min.js" type="text/javascript"></script>
    <script src="//code.angularjs.org/1.2.9/angular-cookies.min.js" type="text/javascript"></script>
    <style>
        .filterbutton{font-variant:small-caps; font-size: 14px;}
        .amount:after{content: " uah";font-variant:small-caps;}
        .action{text-decoration: underline; cursor: pointer;}
        .action:hover{text-decoration: none;}
        #newAmouont{margin-bottom: 2px;}
        .popup{
            background-color: #fff;
            position: fixed;
            top: 50%;
            left: 50%;
            margin-top: -125px;
            margin-left: -100px;
            width: 200px;
            height: 250px;
            box-shadow: -webkit-box-shadow: 0 0 10px 0 #404040;
            box-shadow: 0 0 10px 0 #404040;
        }
        .transactions{max-height: 500px; overflow-y: auto;}
    </style>
</head>
<body ng-controller="controller">
<div class="container">
    <div class="sixteen columns">
        <div class="eleven columns">&nbsp;</div>
        <div class="four columns toggle-users"> <span class="action filterbutton" ng-click="togglePopup('Users');">manage users</span></div>
    </div>
    <div class="sixteen columns">
        <h3>Total balance: <span class="amount">{{pageinfo.summary.total}}</span></h3>
        <h4>In credit: <span class="amount">{{pageinfo.summary.in_credit}}</span></h4>
        <h4>External loan: <span class="amount">{{pageinfo.summary.externalLoan}}</span></h4>
        <h4>In Banka: <span class="amount">{{pageinfo.summary.in_bank}}</span></h4>
    </div>
    <hr/>
    <div class="sixteen columns">
        <div class="two columns">
            <label for="debitRadio">
                <input type="radio" ng-model="newTransaction.type" name="type" id="debitRadio" value="debit" selected="selected" />
                <span>Debit</span>
            </label>
            <label for="payoutRadio">
                <input type="radio" ng-model="newTransaction.type" name="type" id="payoutRadio" value="payout" selected="selected" />
                <span>Payout</span>
            </label>
        </div>
        <div class="four columns">
            <label for="creditRadio">
                <input type="radio" ng-model="newTransaction.type" name="type" id="creditRadio" value="credit" />
                <span>Credit</span>
            </label>
            <label for="repaymentRadio">
                <input type="radio" ng-model="newTransaction.type" name="type" id="repaymentRadio" value="repayment"/>
                <span>Repayment of a credit</span>
            </label>
        </div>
        <div class="three columns">
            <select ng-model="newTransaction.name">
                <option ng-repeat="user in pageinfo.users" value="{{user._id}}" ng-if="!user.disabled" ng-selected="user._id==saveduser">{{user.name}}</option>
            </select>
        </div>
        <div class="two columns">
            <input id="newAmouont" type="text" name="amount" placeholder="Amount" ng-model="newTransaction.amount"/>
            <span class="amount action" ng-click="setAmount(10);">10</span> &nbsp;
            <span class="amount action" ng-click="setAmount(20);">20</span>
        </div>
        <div class="one column">
            <input type="button" ng-click="processTransaction();" value="Add"/>
        </div>
    </div>
    <hr/>
    <div class="eleven columns">
        <h4>Last transactions
            <span id="tr-filters" class="action filterbutton" ng-click="togglePopup('TRFilters');">filters</span>
            <span id="tr-filters" class="action filterbutton" ng-click="togglePopup('TRUsers');">users</span>
        </h4>
        <ul class="transactions">
            <li ng-repeat="transaction in pageinfo.transactions"
                ng-show="transactionfilters.filters[transaction.type] && transactionfilters.users[transaction.name]">
                {{transaction.date}}
                - {{transaction.fullname}}
                - {{transaction.type}}
                - {{transaction.amount}}
                - Banka: {{transaction.summary.in_bank}},
                Credit: {{transaction.summary.in_credit}},
                Loan: {{transaction.summary.externalLoan}},
                Total: {{transaction.summary.total}}
            </li>
        </ul>
    </div>
    <div class="five columns">
        <h4>Debit <small>(since 27.02.2014)</small> </h4>
        <ul><li ng-repeat="user in pageinfo.users" ng-show="user.debit>0">{{user.name}}: {{user.debit}}</li></ul>
    </div>
    <div class="five columns">
        <h4>Credit</h4>
        <ul><li ng-repeat="user in pageinfo.users" ng-show="user.credit>0">{{user.name}}: {{user.credit}}</li></ul>
    </div>
    <div class="five columns">
        <h4>External loan</h4>
        <ul><li ng-repeat="user in pageinfo.users" ng-show="user.credit<0">{{user.name}}: {{-user.credit}}</li></ul>
    </div>
</div>

<div class="popup" ng-show="showPopup.TRFilters">
    <h4>Filters <small class="action" style="float:right" ng-click="togglePopup('TRFilters');">close [x] </small></h4>
    <label ng-repeat="(type, data) in transactionfilters.filters" for="filter-{{type}}">
        <input type="checkbox" id="filter-{{type}}" value="1" ng-model="transactionfilters.filters[type]" />
        <span>{{type}}</span>
    </label>
</div>
<div class="popup" ng-show="showPopup.TRUsers">
    <h4>Users <small class="action" style="float:right" ng-click="togglePopup('TRUsers');">close [x] </small></h4>
    <label ng-repeat="user in pageinfo.users" for="user-{{user._id}}">
        <input type="checkbox" id="user-{{user._id}}" value="1" ng-model="transactionfilters.users[user._id]" />
        <span>{{user.name}}</span>
    </label>
</div>
<div class="popup" ng-show="showPopup.Users">
    <h4>Users disabling <small class="action" style="float:right" ng-click="togglePopup('Users');">close [x] </small></h4>
    <label ng-repeat="(key, user) in pageinfo.users" for="adminuser-{{user._id}}">
        <input
            type="checkbox"
            id="adminuser-{{user._id}}"
            value="1"
            ng-model="pageinfo.users[key].disabled"
            ng-change="toggleUser(user._id, pageinfo.users[key].disabled);"
        />
        <span>{{user.name}}</span>
    </label>
</div>

<script src="//tuugobank.grybov.com/app.js" type="text/javascript"></script>
</body>
</html>